@page "/settings"
@using JournalApp.Services
@using JournalApp.Models

<PageTitle>Settings - Journal App</PageTitle>

<div class="animate-fade-in">
    <MudText Typo="Typo.h3" Class="fw-extra-bold peace-text mb-2">Workspace & Security</MudText>
    <MudText Typo="Typo.h6" Class="secondary-text opacity-60 mb-10">Customize your workspace and vault protection.</MudText>
</div>

<MudGrid>
    <!-- Profile Settings -->
    <MudItem xs="12" md="6">
        <div class="glass pa-8 rounded-xxl mb-6">
            <div class="d-flex align-center mb-6 gap-3">
                <div class="icon-box primary">
                    <MudIcon Icon="@Icons.Material.Filled.Person" Size="Size.Small" />
                </div>
                <MudText Typo="Typo.h6" Class="fw-bold primary-text">Journaler Identity</MudText>
            </div>
            <EditForm Model="@profileModel" OnValidSubmit="UpdateProfile">
                <DataAnnotationsValidator />
                <MudTextField @bind-Value="profileModel.Username" Label="Display Name" Variant="Variant.Outlined" Class="mb-4 rounded-lg" Placeholder="Your brilliant name" />
                <MudTextField @bind-Value="profileModel.Email" Label="Email Address" Variant="Variant.Outlined" InputType="InputType.Email" Class="mb-6 rounded-lg" Placeholder="your@email.com" />
                <div class="d-flex justify-end">
                    <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="rounded-pill px-8 py-3 shadow-primary glow-button">
                        Sync Changes
                    </MudButton>
                </div>
            </EditForm>
        </div>

        <div class="glass pa-8 rounded-xxl mb-6">
            <div class="d-flex align-center mb-6 gap-3">
                <div class="icon-box success">
                    <MudIcon Icon="@Icons.Material.Filled.FileDownload" Size="Size.Small" />
                </div>
                <MudText Typo="Typo.h6" Class="fw-bold">Export Archives</MudText>
            </div>
            <MudText Typo="Typo.body2" Class="mb-6 opacity-60">Generate a permanent record of your journey.</MudText>
            <MudGrid Class="mb-6">
                <MudItem xs="6">
                    <MudDatePicker @bind-Date="exportStartDate" Label="From" Variant="Variant.Outlined" Class="rounded-lg" />
                </MudItem>
                <MudItem xs="6">
                    <MudDatePicker @bind-Date="exportEndDate" Label="To" Variant="Variant.Outlined" Class="rounded-lg" />
                </MudItem>
            </MudGrid>
            <MudButton OnClick="ExportToPdf" Variant="Variant.Filled" Color="Color.Success" StartIcon="@Icons.Material.Filled.PictureAsPdf" Class="rounded-pill px-8 py-3 shadow-success" Disabled="@isExporting" loading="@isExporting">
                Generate PDF Archive
            </MudButton>
        </div>
    </MudItem>

    <MudItem xs="12" md="6">
        <div class="glass pa-8 rounded-xxl">
            <div class="d-flex align-center mb-6 gap-3">
                <div class="icon-box secondary">
                    <MudIcon Icon="@Icons.Material.Filled.Palette" Size="Size.Small" />
                </div>
                <MudText Typo="Typo.h6" Class="fw-bold">Visual Themes</MudText>
            </div>
            <MudText Typo="Typo.body2" Class="mb-4 opacity-60">Control the ambiance of your workspace.</MudText>
            <div class="theme-selector d-flex gap-4 mb-6">
                <div class="theme-pill @(selectedTheme == "Light" ? "active" : "")" @onclick='() => selectedTheme = "Light"'>
                    <MudIcon Icon="@Icons.Material.Filled.LightMode" Size="Size.Small" Class="mr-2" />
                    <span> Light</span>
                </div>
                <div class="theme-pill @(selectedTheme == "Dark" ? "active" : "")" @onclick='() => selectedTheme = "Dark"'>
                    <MudIcon Icon="@Icons.Material.Filled.DarkMode" Size="Size.Small" Class="mr-2" />
                    <span> Dark</span>
                </div>
            </div>
        </div>
    </MudItem>
</MudGrid>

<style>
    .fw-extra-bold { font-weight: 900 !important; }
    .fw-bold { font-weight: 700 !important; }
    .opacity-60 { opacity: 0.6; }
    
    .peace-text {
        color: var(--secondary-color) !important;
    }

    .glass {
        background: var(--surface-1) !important;
        border: 1px solid var(--border-color) !important;
        box-shadow: var(--shadow-md);
    }

    .rounded-xxl { border-radius: 2rem; }

    .icon-box {
        width: 40px;
        height: 40px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .icon-box.primary { background: rgba(47, 107, 95, 0.12); color: var(--primary-color); }
    .icon-box.secondary { background: rgba(201, 106, 75, 0.12); color: var(--secondary-color); }
    .icon-box.tertiary { background: rgba(224, 179, 106, 0.15); color: var(--accent-color); }
    .icon-box.success { background: rgba(47, 143, 106, 0.12); color: var(--success-color); }
    .icon-box.warning { background: rgba(214, 149, 61, 0.12); color: var(--warning-color); }

    .theme-pill {
        padding: 12px 20px;
        border-radius: 12px;
        border: 1px solid var(--border-color);
        cursor: pointer;
        display: flex;
        align-items: center;
        transition: all 0.2s ease;
        flex: 1;
        justify-content: center;
        font-weight: 600;
        color: var(--text-secondary);
        background: rgba(255, 255, 255, 0.7);
    }
    .theme-pill:hover { background: var(--primary-light); }
    .theme-pill.active {
        background: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
        box-shadow: 0 4px 12px -2px rgba(47, 107, 95, 0.3);
    }

    .pin-status { border: 1px solid transparent; }
    .pin-status.active { background: rgba(47, 143, 106, 0.1); border-color: rgba(47, 143, 106, 0.15); color: var(--success-color); }
    .pin-status.warning { background: rgba(214, 149, 61, 0.1); border-color: rgba(214, 149, 61, 0.15); color: var(--warning-color); }

    .shadow-primary { box-shadow: 0 8px 16px -4px rgba(47, 107, 95, 0.4); }
    .shadow-success { box-shadow: 0 8px 16px -4px rgba(47, 143, 106, 0.4); }

    .glow-button {
        transition: all 0.3s ease;
    }
    .glow-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 24px -6px rgba(47, 107, 95, 0.4);
    }

    .animate-fade-in {
        animation: fade-in 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
    }
    @@keyframes fade-in {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>


